import React,{useEffect,useState} from 'react';import {supabase} from '../lib/supabase';export default function Clients({session}){const uid=session.user.id;const[it,si]=useState([]);const[q,sq]=useState('');const[f,sf]=useState({name:'',email:'',phone:'',notes:''});const ld=async()=>{let qu=supabase.from('clients').select('*').eq('user_id',uid).order('created_at',{ascending:false});if(q)qu=qu.ilike('name',`%${q}%`);const{data}=await qu;si(data||[])};useEffect(()=>{ld()},[q]);const save=async e=>{e.preventDefault();await supabase.from('clients').insert([{...f,user_id:uid}]);sf({name:'',email:'',phone:'',notes:''});ld()};const rm=async id=>{await supabase.from('clients').delete().eq('id',id);ld()};return <div className='grid grid-cols-1 md:grid-cols-3 gap-4'><div className='card card-pad'><h3 className='font-semibold mb-3'>Novo cliente</h3><form onSubmit={save} className='space-y-2'><input className='input' placeholder='Nome' value={f.name} onChange={e=>sf({...f,name:e.target.value})} required/><input className='input' placeholder='Email' value={f.email} onChange={e=>sf({...f,email:e.target.value})}/><input className='input' placeholder='Telefone' value={f.phone} onChange={e=>sf({...f,phone:e.target.value})}/><textarea className='input' placeholder='Notas' value={f.notes} onChange={e=>sf({...f,notes:e.target.value})}/><button className='btn-primary w-full'>Salvar</button></form></div><div className='md:col-span-2 card card-pad'><div className='flex items-center justify-between mb-3'><input className='input w-1/2' placeholder='Buscar por nome...' value={q} onChange={e=>sq(e.target.value)}/></div><div className='overflow-x-auto'><table className='w-full text-sm'><thead><tr><th className='p-2'>Nome</th><th className='p-2'>Email</th><th className='p-2'>Telefone</th><th className='p-2'>Ações</th></tr></thead><tbody>{it.map(r=><tr key={r.id} className='border-t'><td className='p-2'>{r.name}</td><td className='p-2'>{r.email}</td><td className='p-2'>{r.phone}</td><td className='p-2'><button onClick={()=>rm(r.id)} className='text-red-500'>Excluir</button></td></tr>)}{it.length===0&&<tr><td className='p-2' colSpan='4'>Sem clientes</td></tr>}</tbody></table></div></div></div>}